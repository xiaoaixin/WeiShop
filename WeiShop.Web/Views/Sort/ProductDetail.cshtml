@model WeiShop.Web.Models.HomeViewModel
@{
    ViewBag.Title = "ProductDetail";
    Layout = "~/Views/_LayoutMaster.cshtml";
}


<link href="~/Content/css/index.css" type="text/css" rel="stylesheet">
<link href="~/Content/css/swiper.min.css" type="text/css" rel="stylesheet">

<script src="~/Scripts/swiper.min.js" type="text/javascript"></script>
<script src="~/Scripts/index.js" type="text/javascript"></script>


<link href="~/Content/css/fullscreenstyle.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="~/Scripts/jquery.fullscreenslides.js"></script>


<!--ftop开始-->
<div class="ftop">
    <a class="back" onClick="javascript:history.back(-1);"><img src="/Content/images/icon_03.png"></a>
    <h2>产品详情</h2>
    <a style="color:#000" class="comea">分享有礼</a>
    <div style="clear: both;"></div>
</div>
<!--ftop开始-->
<!---banner start--->
<div class="product_box">
    <div class="swiper-container product_details">
        <div class="swiper-wrapper">
            @foreach (var item in Model.Product.ProPhotoes)
            {
                <div class="swiper-slide"><a><img src="@item.ImgUrl" alt=""></a></div>
            }
        </div>
    </div>
    <div class="pro_text">
        <h2>
            <p>@Model.Product.Name</p>
            <span><img src="/Content/images/icon_06.png"><img src="/Content/images/icon_06.png"><img src="/Content/images/icon_06.png"><img src="/Content/images/icon_07.png"><img src="/Content/images/icon_07.png"></span>
        </h2>
        <p>@Model.Product.Intro</p>
        <div class="pro_det">
            <h3>
                <i>￥</i><b>@Model.Product.SellPrice</b>
                @foreach (var tag in Model.Product.Tags)
                {
                    <span>@tag.Name</span>
                }
            </h3>
            <p><span>库存：616 </span><i></i><span>月销量：1988笔</span></p>
        </div>
    </div>
</div>
<script>
        var swiper1 = new Swiper('.product_details', {
            slidesPerView:1.5,
            paginationClickable: true,
            spaceBetween: 30,
            freeMode: true
        });
</script>
<!---banner over--->
<div class="pro_standard">

    <div class="shu"><i>购买数量</i><span class="jia"><img src="/Content/images/icon_017.png"></span><input id="sl" class="shopcart-td-num" type="text" value="1" /><span class="jian"><img src="/Content/images/icon_016.png"></span></div>
</div>
<script>
        $(function(){
            var jian = $(".jian");
            var jia = $(".jia");
            var kunchun = 10; //当库存不足时，可以提醒用户。
            jia.click(function() {
                var n = $(this).siblings("input").val();
                n++;
                if (n > kunchun) {
                    alert("库存不足啦!");
                    $(this).siblings("input").val(kunchun - 1);
                    return false;
                }
                $(this).siblings("input").val(n);
                return false;
            });
            jian.click(function() {
                var n = $(this).siblings("input").val();
                n--;
                if (n < 1) {
                    $(this).siblings("input").val(n + 1);
                    return false;
                }
                $(this).siblings("input").val(n);
                return false;
            });
        });
</script>
<div class="pro_description modular">
    <h2><span>商品描述</span></h2>
    <div class="miaoshu">
        @Model.Product.Detail
    </div>
</div>

<div class="pro_description modular">
    <h2><span>更多图片</span></h2>
    <div class="tu_pian">
        <img src="@Model.Product.ProPhotoes.FirstOrDefault(f=>f.No==201).ImgUrl">
        <img src="@Model.Product.ProPhotoes.FirstOrDefault(f=>f.No==202).ImgUrl">
        <img src="@Model.Product.ProPhotoes.FirstOrDefault(f=>f.No==203).ImgUrl">
    </div>
</div>
<div class="pro_description modular">
    <h2><span>用户评价</span></h2>
    <div class="pingjia">
        <div class="pingjia_item">
            <img src="/Content/images/img_06.jpg"><i>李易峰</i><span>06-21 23:22</span>
            <div class="ping_text">
                <p>冬虫夏草为虫体与菌座相冬虫夏草为虫体与菌座相连而成冬虫夏草为虫体与菌座相连而成冬虫夏草为虫体与菌座相连而成连而成，难得的真品，收到货了，确实不错！！</p>
                <div class="wrapper">
                    <div class="image"><a rel="gallery" href="/Content/images/img_01.jpg"><img src="/Content/images/img_02.jpg"></a></div>
                    <div class="image"><a rel="gallery" href="/Content/images/img_01.jpg"><img src="/Content/images/img_02.jpg"></a></div>
                </div>
            </div>
        </div>
        <div class="pingjia_item">
            <img src="/Content/images/img_06.jpg"><i>李易峰</i><span>06-21 23:22</span>
            <div class="ping_text">
                <p>冬虫夏草为虫体与菌座相冬虫夏草为虫体与菌座相连而成冬虫夏草为虫体与菌座相连而成冬虫夏草为虫体与菌座相连而成连而成，难得的真品，收到货了，确实不错！！</p>
            </div>
        </div>
        <div class="pingjia_item">
            <img src="/Content/images/img_06.jpg"><i>李易峰</i><span>06-21 23:22</span>
            <div class="ping_text">
                <p>冬虫夏草为虫体与菌座相冬虫夏草为虫体与菌座相连而成冬虫夏草为虫体与菌座相连而成冬虫夏草为虫体与菌座相连而成连而成，难得的真品，收到货了，确实不错！！</p>
                <div class="wrapper">
                    <div class="image"><a rel="gallery" href="/Content/images/img_01.jpg"><img src="/Content/images/img_02.jpg"></a></div>
                    <div class="image"><a rel="gallery" href="/Content/images/img_01.jpg"><img src="/Content/images/img_02.jpg"></a></div>
                </div>
            </div>
        </div>
    </div>
    
    <script type="text/javascript">
        $(function(){
            $('.image img').fullscreenslides();
            var $container = $('#fullscreenSlideshowContainer');
            $container.bind("init", function() {
                    $container
                        .append('<div class="ui" id="fs-close">&times;</div>')
                        .append('<div class="ui" id="fs-loader">Loading...</div>')
                        .append('<div class="ui" id="fs-prev">&lt;</div>')
                        .append('<div class="ui" id="fs-next">&gt;</div>')
                        .append('<div class="ui" id="fs-caption"><span></span></div>');
                    $('#fs-prev').click(function(){
                        $container.trigger("prevSlide");
                    });

                    $('#fs-next').click(function(){
                        $container.trigger("nextSlide");
                    });

                    $('#fs-close').click(function(){
                        $container.trigger("close");
                    });

                })

                .bind("startLoading", function() {
                    $('#fs-loader').show();
                })

                .bind("stopLoading", function() {
                    $('#fs-loader').hide();
                })

                .bind("startOfSlide", function(event, slide) {

                    $('#fs-caption span').text(slide.title);
                    $('#fs-caption').show();
                })

                .bind("endOfSlide", function(event, slide) {
                    $('#fs-caption').hide();
                });

        });
    </script>
    <div class="fixft pro_bottom">
        <span><b><a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=1690704269&site=qq&menu=yes">客服</a></b><b>收藏</b></span>
        <p><a href="#" class="addshopcar">加入购物车</a><a href="confirm_order.html">立即购买</a></p>
    </div>


    <div id="box" class="sidebar">
        <ul>
            <li><a href="#luxian1" class="linka"><span>商品描述</span><i></i></a></li>
            <li><a href="#luxian2" class="linka"><span>更多图片</span><i></i></a></li>
            <li><a href="#luxian3" class="linka"><span>用户评价</span><i></i></a></li>

        </ul>
        <p class="gotop"><a class="topshang"><span>返回顶部</span><i></i></a></p>
    </div>


    <!--提醒分享-->
    <div class="sharetip">
        <img src="/Content/images/sharetip_06.png" alt="">
        <a><img src="/Content/images/sharetip_09.png" alt=""></a>
    </div>
    <!--提醒分享-->
</div>


<script>
            $(function() {
                $(".ftop .comea").click(function() {
                    $("html,body").css({ "overflow": "hidden" });
                    $(".sharetip").fadeIn();
                });
                $(".sharetip a").click(function() {
                    $("html,body").css({ "overflow": "auto" });
                    $(".sharetip").fadeOut();
                });
            })
</script>




<script>
            /****窗口滚动****/
            window.onscroll = function(){
                var t = document.documentElement.scrollTop || document.body.scrollTop;
                if(t>350){
                    $("#box").show();
                }else{
                    $("#box").hide();
                }
            }
</script>

<script>
            $(function(){
                $("#box a.linka").each(function(n){
                    $(this).on("click", function(){
                        //获得当前第N个div距页面顶部的距离
                        var a = $(".modular").eq(n).offset().top;
                        var b = a - 50;
                        $('html,body').animate({scrollTop: b}, 800);
                    });
                });
            })
</script>

<script>
    $(document).scroll(function() {
        var nowtop= $(document).scrollTop();
        var nowtopa = $(".modularbox .modular").length;
        var aArray = {};//定义一个数组
        for(var i=0;i<nowtopa;i++){
            //aArray[i] = $(".tripdays").eq(i).offset().top;
            gh = $(".modular").eq(i).offset().top;
            gx = $(".modular").eq(i).height();
            if(nowtop > (gh-220) && nowtop< (gh+gx-220)){
                $("#box a.linka").removeClass('on');
                $("#box a.linka").eq(i).addClass('on');
            }
        }
    });
</script>
<script src="~/Scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
<script>    //加入购物车
    $(function() {
        $(".addshopcar").click(function() {
            $.ajax({
                type: "POST",
                url: '@Url.Action("AddShopCar", "ShopCar")',
                data: {
                    procode:@Model.Product.Code,
                    qty:document.getElementById("sl").value
                },
                success: function (msg) {
                    alert(msg);
                }
            });
        });
    });
</script>


